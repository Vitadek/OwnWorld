services:
  # --- Main Registration Node (Seed) ---
  # Allows user registration and acts as the genesis for the federation.
  seed-node:
    build: 
      context: .
      dockerfile: container-builds/Dockerfile
    image: ownworld:latest
    container_name: ownworld-seed
    restart: unless-stopped
    ports:
      - "8080:8080"
    volumes:
      - ./data/seed:/app/data
    environment:
      - FEDERATION_NAME=OfficialGalaxy
      - OWNWORLD_COMMAND_CONTROL=true  # Enables Registration / API
      - OWNWORLD_PEERING_MODE=promiscuous
      - SEED_NODES= # Empty = Genesis Leader

  # --- Base World 1 (Resource Node) ---
  # No registration allowed. Connects to seed.
  world-1:
    image: ownworld:latest
    container_name: ownworld-base-1
    restart: unless-stopped
    ports:
      - "8081:8080"
    volumes:
      - ./data/world1:/app/data
    depends_on:
      - seed-node
    environment:
      - FEDERATION_NAME=OfficialGalaxy
      - OWNWORLD_COMMAND_CONTROL=false # Disables Registration
      - SEED_NODES=http://seed-node:8080

  # --- Base World 2 (Resource Node) ---
  world-2:
    image: ownworld:latest
    container_name: ownworld-base-2
    restart: unless-stopped
    ports:
      - "8082:8080"
    volumes:
      - ./data/world2:/app/data
    depends_on:
      - seed-node
    environment:
      - FEDERATION_NAME=OfficialGalaxy
      - OWNWORLD_COMMAND_CONTROL=false # Disables Registration
      - SEED_NODES=http://seed-node:8080

  # --- Base World 3 (Resource Node) ---
  world-3:
    image: ownworld:latest
    container_name: ownworld-base-3
    restart: unless-stopped
    ports:
      - "8083:8080"
    volumes:
      - ./data/world3:/app/data
    depends_on:
      - seed-node
    environment:
      - FEDERATION_NAME=OfficialGalaxy
      - OWNWORLD_COMMAND_CONTROL=false # Disables Registration
      - SEED_NODES=http://seed-node:8080
