syntax = "proto3";
package federation;
option go_package = "./pkg/federation";

// The "Envelope" for all federation messages
message Packet {
  string sender_uuid = 1;
  bytes signature = 2; // Ed25519
  
  oneof content {
    Heartbeat heartbeat = 3;
    FleetMove fleet_move = 4;
    Handshake handshake = 5;
  }
}

message Heartbeat {
  int64 tick = 1;
  int32 peer_count = 2;
  string genesis_hash = 3;
}

message FleetMove {
  int32 fleet_id = 1;
  string origin_system = 2;
  string dest_system = 3;
  int64 arrival_tick = 4;
  // Compressed JSON of the fleet composition (Fighters, Ark, Cargo)
  bytes fleet_payload = 5; 
}

message Handshake {
  string public_key = 1;
  string address = 2;
  string genesis_hash = 3;
}
